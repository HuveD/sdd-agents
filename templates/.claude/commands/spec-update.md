---
description: 프로젝트를 자동 분석하여 도메인별 사양서를 체계적으로 작성/업데이트합니다 (언어/프레임워크 중립적)
argument-hint: "[옵션: --domains <domain1,domain2>]"
model: claude-sonnet-4-20250514
allowed-tools:
  - Read
  - LS
  - Grep
  - Glob
  - Write
  - MultiEdit
  - Bash
  - TodoWrite
---

# spec-update: 사양서 자동화 시스템

프로젝트를 자동으로 심층 분석하여 핵심 도메인을 식별하고, 각 도메인별로 체계적인 사양서를 작성 또는 업데이트합니다.
사양서는 비즈니스 로직과 기능 요구사항에 초점을 맞추며, 구현 언어나 프레임워크와 무관하게 작성됩니다.

## 1단계: 프로젝트 구조 및 맥락 분석

먼저 프로젝트의 전체 구조와 기술 스택을 파악합니다:

!echo "🔍 프로젝트 구조 분석 시작..."

### 프로젝트 기본 정보 수집
프로젝트 유형을 자동 감지하기 위해 다음 파일들을 확인:

프로젝트 설정 파일들을 확인하여 기술 스택과 프로젝트 구조를 파악합니다.
다양한 언어의 설정 파일, 빌드 구성, 의존성 관리 파일을 자동으로 탐색합니다.

!find . -maxdepth 2 -type f \( -name "package.json" -o -name "requirements.txt" -o -name "pom.xml" -o -name "go.mod" -o -name "Cargo.toml" -o -name "Gemfile" -o -name "*.csproj" -o -name "composer.json" -o -name "build.gradle" -o -name "Makefile" \) 2>/dev/null | head -20

### 프로젝트 문서
@README.md (if exists)
@.gitignore (if exists)

### 프로젝트 디렉토리 구조 분석
!find . -type d \( -name "node_modules" -o -name "venv" -o -name ".venv" -o -name "__pycache__" -o -name "target" -o -name "build" -o -name "dist" -o -name "vendor" -o -name ".git" \) -prune -o -type d -print | head -40

### 주요 소스 코드 디렉토리 파악
!ls -la

## 2단계: 도메인 식별 및 분류

프로젝트의 핵심 도메인을 다음 기준으로 식별합니다:
- 디렉토리 구조 기반 도메인
- 기능 모듈 기반 도메인  
- 비즈니스 로직 기반 도메인

### 도메인 자동 탐지
언어별 일반적인 프로젝트 구조 패턴으로 도메인을 식별:

프로젝트의 디렉토리 구조를 분석하여 다음과 같은 패턴으로 도메인을 식별합니다:

1. **기능별 구조**: 각 디렉토리가 특정 기능이나 비즈니스 도메인을 나타내는 경우
2. **계층별 구조**: 기술 계층(컨트롤러, 서비스, 모델 등)으로 구성된 경우
3. **모듈별 구조**: 독립적인 모듈이나 패키지로 구성된 경우
4. **마이크로서비스 구조**: 각 서비스가 별도 디렉토리로 구성된 경우

각 프로젝트의 고유한 구조를 인식하여 비즈니스 도메인을 추출합니다.

## 3단계: 기존 사양서 현황 파악

!echo "📋 기존 사양서 확인 중..."
!ls -la docs/specs/ 2>/dev/null || echo "docs/specs 디렉토리가 없습니다. 새로 생성합니다."

## 4단계: 도메인별 사양서 작성 계획 수립

식별된 각 도메인에 대해:
1. docs/specs/ 디렉토리에서 기존 사양서 존재 여부 확인
2. 코드베이스 분석을 통해 사양서와 실제 구현의 차이 파악
3. 신규 작성이 필요한 도메인과 업데이트가 필요한 도메인 분류
4. 우선순위 설정 (핵심 비즈니스 로직부터 처리)

**중요**: 기존 사양서가 있더라도 코드와 불일치하거나 누락된 내용이 있으면 자동으로 업데이트합니다.

## 5단계: spec-document-writer 병렬 실행

### 실행 전략
- 각 도메인에 대해 spec-document-writer 에이전트를 독립적으로 호출
- 최대 3개까지 병렬 처리 (시스템 리소스 고려)
- 각 에이전트는 해당 도메인의 전체 맥락을 분석하여 완성된 사양서 생성
- **중요**: 사양서는 비즈니스 로직과 기능 요구사항에 집중하며, 특정 구현 언어나 프레임워크에 종속되지 않도록 작성

### 병렬 처리 구현

모든 식별된 도메인에 대해:
1. 최대 3개씩 병렬로 spec-document-writer 에이전트 실행
2. 각 에이전트는 도메인의 완전한 분석과 사양서 작성/업데이트 수행
3. 신규 작성과 업데이트를 동시에 진행
4. 우선순위에 따라 처리 순서 결정:
   - 핵심 비즈니스 로직 도메인
   - 주요 기능 도메인
   - 보조/유틸리티 도메인

## 6단계: 결과 검증 및 요약

### 검증 항목
- 모든 도메인에 대한 사양서 존재 확인
- 사양서 형식 및 완성도 검증
- 도메인 간 일관성 확인

### 최종 보고서
생성/업데이트된 모든 사양서 목록과 상태를 제공:

```
📊 spec-update 실행 결과:
- 식별된 도메인: X개
- 신규 작성된 사양서: Y개  
- 업데이트된 사양서: Z개
- 검증 완료: ✅

각 도메인별 상세:
1. [도메인명]: [상태] - [파일경로]
2. ...
```

## 실행 옵션 처리

입력된 인자($ARGUMENTS)에 따라 동작을 조정:
- `--domains <list>`: 지정된 도메인만 처리
- **인자 없음 (기본)**: 전체 프로젝트 분석 후 모든 도메인에 대해 사양서 신규 작성 및 업데이트 자동 수행

## 주의사항

- 대규모 프로젝트의 경우 시간이 소요될 수 있습니다
- 각 spec-document-writer는 완전한 사양서를 생성합니다
- docs/specs/ 디렉토리가 없으면 자동 생성됩니다
- 모든 사양서는 한글로 작성됩니다
- **자동 업데이트**: 기존 사양서가 코드와 불일치하거나 누락된 내용이 있으면 사용자 확인 없이 자동 업데이트
- **언어 중립적 작성**: 비즈니스 요구사항과 기능 명세에 집중하며, 특정 프로그래밍 언어나 프레임워크 세부사항은 제외
- **전체 처리가 기본**: 인자 없이 실행하면 모든 도메인의 사양서를 신규 작성 및 업데이트

이제 프로젝트를 자동 분석하고 도메인별로 체계적인 사양서를 작성하겠습니다.